# Glitch 更新手順

## 1. 環境変数の設定

1. Glitch プロジェクトの「.env」ファイルに以下の変数を追加：
   ```
   GLITCH_API_TOKEN=your-api-token
   ALLOWED_ORIGINS=https://slack.com
   PORT=3000
   NODE_ENV=production
   ```

## 2. 依存関係の更新

1. package.json の更新

   ```bash
   git pull origin main
   ```

2. 新しい依存関係のインストール
   ```bash
   refresh
   ```

## 3. アプリケーションの更新

1. 新しいコードの取得

   ```bash
   git pull origin main
   ```

2. サーバーの再起動
   ```bash
   refresh
   ```

## 4. 動作確認

1. Slack アプリの設定を確認

   - マニフェストが正しく更新されているか
   - 必要なスコープが追加されているか

2. ワークフローの設定

   - 「経費精算書の作成」ワークフローが利用可能か
   - フォームの入力項目が正しく表示されるか

3. テスト実行
   - 領収書ファイルのアップロード
   - OCR 処理の動作確認
   - スプレッドシートへの登録確認

## 5. トラブルシューティング

### エラーログの確認

```bash
# ログの表示
watch glitch-logs
```

### よくあるエラー

1. 依存関係のエラー

   ```bash
   refresh
   ```

2. 環境変数の問題

   - .env ファイルの設定を確認
   - 必要な変数がすべて設定されているか確認

3. 権限の問題

   - Slack アプリのスコープを確認
   - Google API の認証情報を確認

4. ネットワークエラー
   - Glitch プロジェクトが起動しているか確認
   - エンドポイントの URL が正しいか確認

## 6. バックアップ

1. 重要なファイルのバックアップ

   - .env ファイル
   - credentials.json
   - カスタム設定ファイル

2. データのバックアップ
   - スプレッドシートのバックアップ
   - アップロードされたファイルのバックアップ
